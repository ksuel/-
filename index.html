<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>《班级的蜕变》校园教育小品剧本</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: "Microsoft YaHei", "SimHei", sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }
        h1 {
            font-size: 32px;
            color: #1e3a8a;
            margin-bottom: 10px;
        }
        h2 {
            font-size: 24px;
            color: #2563eb;
            margin: 25px 0 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e9ecef;
        }
        h3 {
            font-size: 20px;
            color: #3b82f6;
            margin: 20px 0 10px;
        }
        .subtitle {
            font-size: 18px;
            color: #666;
            font-weight: normal;
        }
        .note {
            background-color: #f0f9ff;
            padding: 15px;
            border-left: 4px solid #3b82f6;
            margin: 20px 0;
            border-radius: 4px;
        }
        .info-section {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }
        .info-list {
            list-style-type: none;
        }
        .info-list li {
            margin-bottom: 10px;
            display: flex;
            align-items: flex-start;
        }
        .info-list strong {
            min-width: 120px;
            display: inline-block;
            color: #1e3a8a;
        }
        .character-list {
            list-style-type: decimal;
            padding-left: 25px;
            margin: 15px 0;
        }
        .character-list li {
            margin-bottom: 15px;
        }
        .character-name {
            font-weight: bold;
            color: #1e3a8a;
        }
        .scene {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-style: italic;
        }
        .dialogue {
            margin: 20px 0;
        }
        .dialogue-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .dialogue-table th, .dialogue-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        .dialogue-table th {
            background-color: #f1f5f9;
            color: #1e3a8a;
            font-weight: bold;
        }
        .character-dialogue {
            font-weight: bold;
            color: #1e40af;
        }
        .action {
            color: #4b5563;
            font-style: italic;
        }
        .narrator {
            font-style: italic;
            color: #6b7280;
            margin: 10px 0;
        }
        .meta-info {
            background-color: #f1f5f9;
            padding: 15px;
            border-radius: 6px;
            margin-top: 30px;
        }
        .ending-note {
            font-style: italic;
            text-align: center;
            margin: 30px 0;
            color: #6b7280;
        }
        .hr-fancy {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(59, 130, 246, 0.75), rgba(0, 0, 0, 0));
            margin: 30px 0;
        }
        @media print {
            body * {
                visibility: hidden;
            }
            #print-content, #print-content * {
                visibility: visible !important;
                display: block !important;
            }
            #print-content {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
                display: block !important;
            }
            .print-header {
                text-align: center;
                margin-bottom: 30px;
                padding-bottom: 15px;
                border-bottom: 1px solid #ddd;
            }
            .print-title {
                font-size: 24px;
                font-weight: bold;
                margin-bottom: 10px;
                color: #1e3a8a;
            }
            .print-subtitle {
                font-size: 18px;
                color: #444;
                margin-bottom: 20px;
            }
            .highlighted-character {
                font-size: 18px !important;
                font-weight: bold !important;
                color: #0d47a1 !important;
                background-color: #e3f2fd !important;
                padding: 3px 6px !important;
                border-radius: 4px !important;
            }
            .watermark {
                position: fixed;
                bottom: 5%;
                left: 0;
                right: 0;
                text-align: center;
                color: #888;
                opacity: 0.7;
                transform: rotate(-10deg);
                z-index: 1000;
                font-size: 18px;
                font-weight: bold;
            }
            .print-button-container {
                display: none;
            }
            h2 {
                color: #2563eb !important;
                font-size: 20px !important;
                margin-top: 25px !important;
                border-bottom: 1px solid #ddd !important;
                padding-bottom: 5px !important;
            }
            h3 {
                color: #3b82f6 !important;
                font-size: 18px !important;
                margin-top: 15px !important;
                margin-left: 10px !important;
            }
            p {
                margin-left: 20px !important;
            }
            a {
                text-decoration: none !important;
                color: inherit !important;
            }
            /* 封面样式 */
            .print-cover {
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                height: 100vh;
                text-align: center;
            }
            .cover-title {
                font-size: 36px;
                font-weight: bold;
                margin-bottom: 30px;
                color: #1e3a8a;
            }
            .cover-subtitle {
                font-size: 24px;
                margin-bottom: 40px;
                color: #3b82f6;
            }
            .cover-character {
                font-size: 28px;
                margin-bottom: 50px;
                padding: 10px 30px;
                border: 2px solid #3b82f6;
                border-radius: 10px;
                color: #1e3a8a;
            }
            .cover-date {
                font-size: 18px;
                margin-bottom: 80px;
                color: #666;
            }
            .cover-footer {
                font-size: 22px;
                font-weight: bold;
                color: #64748b;
            }
            /* 签名栏样式 */
            .signature-section {
                margin-top: 50px;
                margin-bottom: 30px;
                text-align: right;
                padding-right: 50px;
            }
            .signature-line {
                width: 200px;
                height: 1px;
                background-color: #000;
                margin-left: auto;
                margin-bottom: 5px;
            }
            .signature-text {
                font-size: 14px;
                color: #666;
            }
            /* 场景描述和旁白文本样式 */
            .scene-description {
                font-style: italic !important;
                background-color: #f8f9fa !important;
                padding: 10px !important;
                margin: 10px 0 !important;
                border-radius: 5px !important;
                color: #4b5563 !important;
            }
            .narrator-text {
                font-style: italic !important;
                color: #6b7280 !important;
                margin: 10px 0 10px 20px !important;
                background-color: #f9fafb !important;
                padding: 5px 10px !important;
                border-left: 3px solid #d1d5db !important;
            }
        }
        
        .print-button-container {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .print-button-container h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #1e3a8a;
        }
        
        .character-select {
            padding: 10px 15px;
            border-radius: 4px;
            border: 1px solid #bbd0ff;
            margin-right: 15px;
            width: 200px;
            font-size: 16px;
            color: #1e3a8a;
            background-color: #fff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%233b82f6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            padding-right: 30px;
        }
        
        .character-select:focus {
            border-color: #3b82f6;
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
        }
        
        .character-select option {
            padding: 10px;
        }
        
        .print-btn {
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 18px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 16px;
            font-weight: 500;
            margin-right: 10px;
            box-shadow: 0 2px 4px rgba(37, 99, 235, 0.3);
        }
        
        .print-btn:hover {
            background-color: #1d4ed8;
            box-shadow: 0 2px 6px rgba(37, 99, 235, 0.4);
        }
        
        .print-btn:active {
            background-color: #1e40af;
            transform: translateY(1px);
        }
        
        .export-btn {
            background-color: #059669;
            color: white;
        }
        
        .export-btn:hover {
            background-color: #047857;
        }
        
        #print-content {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>《班级的蜕变》</h1>
            <p class="subtitle">校园教育小品剧本</p>
        </header>

        <div class="print-button-container">
            <h3>角色台词打印和导出</h3>
            <div>
                <select id="character-select" class="character-select">
                    <option value="">请选择角色</option>
                    <option value="林阳">林阳</option>
                    <option value="刘浩">刘浩</option>
                    <option value="小美">小美</option>
                    <option value="小强">小强</option>
                    <option value="阿文">阿文</option>
                    <option value="小钱">小钱</option>
                    <option value="李老师">李老师</option>
                    <option value="体育老师">体育老师</option>
                    <option value="小林">小林</option>
                    <option value="小颖">小颖</option>
                    <option value="王主任">王主任</option>
                    <option value="主持人">主持人</option>
                    <option value="all">所有角色台词（完整版）</option>
                </select>
                <button id="print-button" class="print-btn">打印台词</button>
                <button id="export-button" class="print-btn export-btn">导出Word文档</button>
            </div>
            <p style="margin-top: 10px; font-size: 14px; color: #666;">
                提示：打印时将自动生成封面、高亮选定角色台词并添加签名栏<br>
                选择特定角色时，会导出/打印包含<strong>全剧本内容</strong>，并<strong>高亮显示</strong>选定角色的台词。
            </p>
        </div>

        <div class="note">
            <p>本剧以高中校园生活为背景，通过描述一个班级从分裂到团结的故事，展现了不同性格学生间的成长与蜕变。剧本揭示了班级集体与个人责任的关系，具有积极的教育意义。</p>
        </div>

        <div class="info-section">
            <h2>基本信息</h2>
            <ul class="info-list">
                <li><strong>剧本类型：</strong>校园小品</li>
                <li><strong>表演时长：</strong>25-30分钟</li>
                <li><strong>人物数量：</strong>10人</li>
                <li><strong>适合观众：</strong>高中生、教师、家长</li>
                <li><strong>主题：</strong>团结、责任、集体精神、自我管理</li>
            </ul>
        </div>

        <h2>人物表</h2>
        <ul class="character-list">
            <li><span class="character-name">林阳：</span>原班长，性格沉稳、务实、正直，有担当，技术能力强，为班级默默付出。</li>
            <li><span class="character-name">刘浩：</span>现班长，活泼外向，喜欢表现自己，善于社交，笼络了一批追随者。</li>
            <li><span class="character-name">小美：</span>班级学习委员，成绩优秀，性格正直，是林阳的支持者。</li>
            <li><span class="character-name">小强：</span>班级体育委员，刘浩的好友，运动能力不错，但经常不认真训练。</li>
            <li><span class="character-name">阿文（陈锦辉）：</span>班级里的"网瘾少年"，上课注意力不集中，下课沉迷游戏，刘浩小团体成员。</li>
            <li><span class="character-name">小钱：</span>刘浩的朋友，家境较好，经常参与刘浩组织的活动。</li>
            <li><span class="character-name">李老师：</span>班主任，关心学生，但对班级的变化有些束手无策。</li>
            <li><span class="character-name">王主任：</span>教导主任，严厉正直，最后给予关键指导。</li>
            <li><span class="character-name">小林（卢雨杭）：</span>班级里的安静学生，旁观者，后来站出来支持林阳。</li>
            <li><span class="character-name">小颖：</span>有主见，最初被刘浩的活动吸引，后来看清问题本质。</li>
        </ul>

        <hr class="hr-fancy">

        <h2>第一幕：班级的变化</h2>
        <div class="scene">
            <p>舞台：教室场景，桌椅摆放整齐，黑板上写着"高一（10）班"。</p>
        </div>

        <h3>第一场</h3>
        <div class="narrator">（铃声响起，下课时间，教室里热闹非凡）</div>

        <table class="dialogue-table">
            <thead>
                <tr>
                    <th>角色</th>
                    <th>台词/动作</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="character-dialogue">阿文</td>
                    <td><span class="action">（大声喊着，拿着手机）</span>兄弟们！这把我五杀了！<span class="action">（做出夸张动作）</span></td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td><span class="action">（拍桌子）</span>牛啊！下一把带我！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（穿着时尚的衣服，走到教室中央）</span>听说新出的游戏挺好玩，我已经充了2000了，要不要一起？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小钱</td>
                    <td><span class="action">（崇拜地）</span>浩哥就是浩哥，出手大方！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（得意地）</span>小事小事，对了，我这有零食，大家一起吃。<span class="action">（拿出一堆零食分给周围人）</span></td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td>浩哥真仗义！</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（林阳安静地坐在角落看书，抬头看了看这一幕，摇摇头）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td><span class="action">（走到林阳身边）</span>林阳，你怎么不去玩？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（平静地）</span>下节课要交物理作业，我在检查一下。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td><span class="action">（叹气）</span>自从刘浩当了班长，班级纪律越来越差了。以前你当班长的时候不是这样的。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td>每个人有每个人的方式吧。只要同学们喜欢就好。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td>可这样下去不行啊，期中考试我们班已经从年级第五掉到十五名了。</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（铃声响起，预示着上课时间到了）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（走进教室，看到一片嘈杂）</span>同学们，上课了！请回到座位上！</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（学生们慢慢地回到座位，有人还在玩手机）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（严肃地）</span>阿文，请把手机收起来！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">阿文</td>
                    <td><span class="action">（不耐烦）</span>知道了知道了，这就收。<span class="action">（小声）</span>这老师真烦人。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（小声对周围人说）</span>别理她，下课我请大家吃麻辣烫。</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（几个同学偷笑）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（无奈地看着班级）</span>今天我们继续讲解上次的考试题...</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（课堂上，一半学生注意力不集中，一半学生玩手机或者传纸条）</div>

        <hr class="hr-fancy">

        <h2>第二幕：冲突与反思</h2>
        <h3>第一场</h3>
        <div class="scene">
            <p>舞台：学校操场，体育课场景。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td><span class="action">（懒洋洋地）</span>今天体育课内容太无聊了，我们自由活动吧。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（拍拍小强的肩）</span>对，你是体育委员，你说了算。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">体育老师</td>
                    <td><span class="action">（远处喊）</span>同学们，今天我们要进行体育测试，请排队准备！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td><span class="action">（对周围同学说）</span>那个...不想测试的跟我来，我们去打篮球。</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（一群学生跟着小强离开，只有林阳和少数几个学生留下来）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">体育老师</td>
                    <td><span class="action">（走过来）</span>其他人呢？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（诚实地）</span>老师，他们去打篮球了。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">体育老师</td>
                    <td><span class="action">（生气地）</span>这个班怎么回事？纪律性这么差？谁是班长？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（犹豫了一下）</span>刘浩是班长。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">体育老师</td>
                    <td>等他们回来，都要记名字！</td>
                </tr>
            </tbody>
        </table>

        <h3>第二场</h3>
        <div class="scene">
            <p>舞台：教室场景，班会课。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（站在讲台上）</span>下周是艺术节，我们班也要出一个节目。我已经和我的朋友们商量好了，我们要表演街舞，人选我已经定好了。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小颖</td>
                    <td><span class="action">（举手）</span>班长，可以把名单说一下吗？大家都想参与。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（不耐烦地）</span>就是我和小强、阿文、小钱他们几个。别的人就不用操心了。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小林</td>
                    <td><span class="action">（小声对旁边同学说）</span>又是他们几个，每次活动都是这样。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td><span class="action">（站起来）</span>刘浩，艺术节是全班的事，应该让有兴趣的同学都有机会参与，我们可以投票选择节目形式和参演人员。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（不在意）</span>投什么票？我是班长，我说了算。再说了，你们有街舞基础吗？到时候表现不好怎么办？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（平静地站起来）</span>艺术节是展示班级风采的机会，不应该变成少数人的表演舞台。如果是街舞，我们可以组织有兴趣的同学一起学习，共同进步。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（不满地）</span>哟，前任班长要指导我工作啊？你当班长的时候，班级活动有多枯燥大家都知道。<span class="action">（转向其他同学）</span>是不是啊？</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（刘浩的小团体附和着笑）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">小颖</td>
                    <td><span class="action">（认真地）</span>林阳说得对，艺术节是全班的事。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（不屑地）</span>那你们自己弄一个节目去报名吧，反正我们已经报了街舞了。<span class="action">（对小强挥手）</span>走，练舞去。</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（刘浩带着小团体离开，教室里剩下其他同学）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td><span class="action">（无奈地）</span>他们总是这样，什么事情都是小圈子决定。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（思考着）</span>也许我们应该想想班级究竟出了什么问题。</td>
                </tr>
            </tbody>
        </table>

        <hr class="hr-fancy">

        <h2>第三幕：转机与觉醒</h2>
        <h3>第一场</h3>
        <div class="scene">
            <p>舞台：教导处办公室。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td><span class="action">（严肃地看着李老师）</span>李老师，你们班最近怎么回事？期中考试成绩下滑严重，体育课还有学生私自离队，艺术节报名也出现分裂。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（无奈地）</span>主任，自从刘浩当了班长，班级确实出现了一些问题。他很有号召力，但是把班级分成了几个小团体。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td>这样下去不行。现在距离期末考试只有两个月了，再不解决问题，这届学生的高考怎么办？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td>我尝试过和刘浩谈话，但效果不明显。班里也有同学对现状不满，特别是以前的班长林阳。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td><span class="action">（思考状）</span>林阳...我记得他，沉稳的学生，为什么换掉他当班长？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td>当时是民主选举，刘浩承诺要带领大家办更多活动，让班级更活跃。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td><span class="action">（坚定地）</span>李老师，明天我去旁听你们班的课，了解一下情况。这个问题必须解决，但要让学生自己认识到问题所在。</td>
                </tr>
            </tbody>
        </table>

        <h3>第二场</h3>
        <div class="scene">
            <p>舞台：教室，上课时间。王主任坐在后排旁听。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（站在讲台上）</span>今天我们要讨论艺术节的准备情况。目前我们班有两个节目报名，一个是刘浩同学带领的街舞表演，另一个是林阳同学组织的小品《班级的蜕变》。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（站起来，自信满满）</span>老师，我们街舞排练得很好，肯定能拿奖。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（温和地）</span>我们小品也在认真准备，讲述的是一个班级面临问题、解决问题的故事。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（讽刺地）</span>小品？谁还看小品啊，太土了吧。我们跳街舞多酷啊！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td>每个节目都有价值，不要互相贬低。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td><span class="action">（从后排站起来）</span>同学们好，我对你们班的两个节目都很感兴趣。不如这样，两天后我来看看你们的排练情况，然后给些建议，如何？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（有些紧张但故作镇定）</span>没问题，主任到时候就知道我们有多厉害了！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td>谢谢主任，我们会认真准备的。</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（下课铃响起，学生们陆续离开）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td><span class="action">（对李老师）</span>我有个主意，可能对解决班级问题有帮助。</td>
                </tr>
            </tbody>
        </table>

        <h2>第四幕：小品排练与真相大白</h2>
        <h3>第一场</h3>
        <div class="scene">
            <p>舞台：排练教室。林阳和几位同学正在排练小品。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（拿着剧本）</span>小美，这段台词要表现出你对班级现状的担忧，但不要过于批判。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td>明白，我会表现得更真实一些。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小林</td>
                    <td>林阳，这个小品是不是影射我们班现在的情况？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（认真地）</span>是的，但不是为了批评谁，而是希望通过这个故事让大家思考，一个班级应该怎样共同进步。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小颖</td>
                    <td>我觉得这个主题很有意义。我刚开始觉得刘浩组织的活动很有趣，但后来发现班级学习氛围越来越差了。</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（门突然被推开，刘浩带着小强、阿文走进来）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（略带嘲讽）</span>哟，排练得挺认真啊！给我们看看是什么内容？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（平静地）</span>你们也可以一起参与，这是关于班级团结的故事。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（拿过剧本翻看）</span>等等，这不是在说我吗？"班长只顾自己小圈子"...你什么意思？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td>刘浩，这只是个故事，不要对号入座。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（生气地）</span>明明就是在说我！你们排这个小品是想让全校同学笑话我吗？</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（站起来，严肃地）</span>刘浩，我们不是为了批评你，而是想反映班级的现状。自从你当了班长，班级确实分成了几个小团体，学习氛围也变差了，这是事实。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td><span class="action">（有些尴尬）</span>浩哥，其实...我们体育成绩确实下滑了不少。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">阿文</td>
                    <td><span class="action">（低头）</span>我最近游戏玩得太多，上课都开始跟不上了。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（震惊地）</span>你们也这么认为？</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（王主任和李老师走进教室）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td>看来你们正在热烈讨论。我想听听你们对班级现状的真实想法。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小颖</td>
                    <td><span class="action">（鼓起勇气）</span>主任，我觉得我们班现在分成几个小圈子，大家不够团结。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小林</td>
                    <td>班级活动确实变多了，但成绩却下滑得厉害。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（自我辩解）</span>我只是想让班级氛围更活跃一些...</td>
                </tr>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td><span class="action">（温和但坚定）</span>刘浩，做班长不仅是组织活动，更重要的是带领全班同学共同进步。你有热情，这很好，但方向需要调整。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（低头思考，沉默片刻）</span>我...我可能真的只顾着和朋友们玩了，没有考虑整个班级。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（走到刘浩面前）</span>其实我们都希望班级好，只是方式不同。你有很多好的想法和活力，如果能为整个班级考虑，会更好。</td>
                </tr>
            </tbody>
        </table>

        <h3>第二场</h3>
        <div class="scene">
            <p>舞台：教室里，全班集会。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（站在讲台上，表情严肃）</span>同学们，这段时间我反思了很多。作为班长，我没有尽到责任，只顾着和朋友们玩，导致班级分成了小团体，学习氛围也变差了。我向大家道歉。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td>我也要道歉，作为体育委员，我没有认真组织大家训练。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">阿文</td>
                    <td>我承认自己沉迷游戏，影响了学习，也带坏了班风。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（诚恳地）</span>经过和林阳、主任的谈话，我意识到班级需要团结。我提议，艺术节上我们合并两个节目，一起表演小品《班级的蜕变》，小品中可以加入街舞元素。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（站起来）</span>我支持这个提议。如果大家同意，我希望刘浩能继续担任班长，我愿意担任副班长，我们一起为班级工作。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td>我同意！刘浩有活力，林阳有责任心，你们一起带领班级会更好！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（欣慰地）</span>看到你们能认识到问题，并找到解决方案，我非常高兴。班级需要团结，每个人都有责任。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">全班同学</td>
                    <td><span class="action">（齐声）</span>我们支持！</td>
                </tr>
            </tbody>
        </table>

        <h2>第五幕：艺术节与蜕变</h2>
        <h3>第一场</h3>
        <div class="scene">
            <p>舞台：学校艺术节舞台，一个主持台和表演区域。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">主持人</td>
                    <td>接下来有请高一（10）班带来的小品《班级的蜕变》！</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（灯光变暗，然后聚焦在舞台中央。高一（10）班的同学们开始表演他们的小品，内容正是班级从分裂到团结的故事。刘浩和林阳在剧中分别扮演了班长角色，展现了不同的领导风格。在小品中，还加入了街舞元素，由刘浩和小强等人表演。）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（在小品结尾处，站在台前）</span>每个班级都会经历问题，关键是我们如何面对它、解决它。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（站在刘浩旁边）</span>团结就是力量，当我们放下分歧，共同前进，没有什么困难不能克服。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td>班级是我们共同的家，每个人都有责任让它变得更好。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td>成长就是认识自己的不足，并有勇气改变。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">阿文</td>
                    <td>我们每个人都在经历着蜕变，成为更好的自己。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">全体演员</td>
                    <td><span class="action">（齐声）</span>这就是我们的故事——班级的蜕变！</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（观众席爆发出热烈的掌声）</div>

        <h3>第二场</h3>
        <div class="scene">
            <p>舞台：教室，一个月后的班会课。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（兴奋地）</span>同学们，公布一个好消息，这次月考，我们班从年级第十五名上升到第六名！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">全班同学</td>
                    <td><span class="action">（欢呼）</span>太好了！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（站在讲台上）</span>这是大家共同努力的结果。这个月我们在学习和活动之间找到了平衡，早读和晚自习的出勤率达到了98%。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td>我们还建立了互助小组，成绩好的同学帮助有困难的同学，大家一起进步。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td>艺术节上我们获得了最佳表演奖，小品的内容也得到了老师和同学们的认可。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td>体育方面，我们班篮球队在年级比赛中获得了亚军，大家都很认真训练。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">阿文</td>
                    <td><span class="action">（有些不好意思）</span>我...我已经一个月没有在课堂上玩手机了，数学从59分提高到了78分。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小钱</td>
                    <td>我发现学习也挺有意思的，尤其是大家一起讨论问题的时候。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小林</td>
                    <td>我觉得我们班现在真的像一个大家庭，每个人都更自信了。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小颖</td>
                    <td>最重要的是，我们不再有小团体了，大家都能一起学习、一起玩。</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（王主任和校长走进教室）</div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">王主任</td>
                    <td>听说你们班有了很大变化，我们特意来看看。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">校长</td>
                    <td>艺术节的小品我也看了，非常有教育意义。更难能可贵的是，你们把小品中的精神真正带到了现实中。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td>这是同学们自己的功劳，尤其是刘浩和林阳，他们共同带领班级走出了困境。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">校长</td>
                    <td><span class="action">（对全班同学）</span>希望你们记住这次经历，团结协作、共同成长的精神将伴随你们一生。</td>
                </tr>
            </tbody>
        </table>

        <h2>终幕</h2>
        <div class="scene">
            <p>舞台：半年后，教室。夕阳的光透过窗户照射进来。</p>
        </div>

        <table class="dialogue-table">
            <tbody>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（站在教室中央）</span>同学们，我们成功了！期末考试，我们班升到了年级第三名！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（激动地）</span>这是我们共同的胜利，证明了团结的力量！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小美</td>
                    <td>班里的每个人都进步了，阿文的数学甚至考了92分！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">阿文</td>
                    <td><span class="action">（不好意思地笑）</span>这都是大家帮助的结果。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小强</td>
                    <td>我们班篮球队在学校比赛中也获得了冠军！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小钱</td>
                    <td>最重要的是，我们每个人都找到了自己的价值，班级像一个大家庭。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">李老师</td>
                    <td><span class="action">（走进教室，面带微笑）</span>看到你们的变化，我真的很欣慰。你们不仅在学习上进步了，更重要的是，你们学会了团结、责任和自我管理。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">刘浩</td>
                    <td><span class="action">（走到林阳身边）</span>谢谢你，林阳。没有你的坚持和包容，我可能还在带着小团体胡闹。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">林阳</td>
                    <td><span class="action">（拍拍刘浩的肩）</span>我们互相成就，你的活力和创新思维也让班级变得更加生动。</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小颖</td>
                    <td>听说下个学期学校要评选"最佳班集体"，我觉得我们班很有希望！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">小林</td>
                    <td>不管结果如何，我们已经是最棒的班级了！</td>
                </tr>
                <tr>
                    <td class="character-dialogue">全班同学</td>
                    <td><span class="action">（围成一圈，手搭在一起）</span>团结、进步、超越！</td>
                </tr>
            </tbody>
        </table>

        <div class="narrator">（灯光渐暗，音乐响起，表演结束）</div>

        <hr class="hr-fancy">

        <div class="meta-info">
            <h3>作品信息</h3>
            <ul class="info-list">
                <li><strong>表演时长：</strong>25-30分钟</li>
                <li><strong>角色数量：</strong>10个主要角色</li>
                <li><strong>目标观众：</strong>高中生、教师、家长</li>
                <li><strong>核心主题：</strong>班级凝聚力、责任感、团结精神、集体荣誉</li>
                <li><strong>教育价值：</strong>引导学生思考班级管理、集体精神和个人责任的关系</li>
            </ul>
        </div>

        <div class="ending-note">
            <p>本剧本适合校园艺术节、班级汇演等场合表演，具有积极的教育意义和引导作用。</p>
        </div>
    </div>

    <div id="print-content"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const characterSelect = document.getElementById('character-select');
            const printButton = document.getElementById('print-button');
            const exportButton = document.getElementById('export-button');
            const printContent = document.getElementById('print-content');
            
            function collectDialogues() {
                const dialogues = [];
                const tables = document.querySelectorAll('.dialogue-table');
                
                tables.forEach(table => {
                    let sceneName = '';
                    let actName = '';
                    
                    let prevElem = table.previousElementSibling;
                    while (prevElem) {
                        if (prevElem.tagName === 'H3') {
                            sceneName = prevElem.textContent;
                            break;
                        }
                        prevElem = prevElem.previousElementSibling;
                    }
                    
                    prevElem = table;
                    while (prevElem) {
                        if (prevElem.tagName === 'H2') {
                            actName = prevElem.textContent;
                            break;
                        }
                        prevElem = prevElem.previousElementSibling;
                    }
                    
                    const rows = table.querySelectorAll('tbody tr');
                    rows.forEach(row => {
                        const characterCell = row.querySelector('.character-dialogue');
                        if (characterCell) {
                            const character = characterCell.textContent;
                            const dialogue = row.querySelector('td:nth-child(2)').innerHTML;
                            
                            dialogues.push({
                                act: actName,
                                scene: sceneName,
                                character: character,
                                dialogue: dialogue
                            });
                        }
                    });
                });
                
                return dialogues;
            }
            
            function printCharacterDialogues(character) {
                const dialogues = collectDialogues();
                let content = '';
                let printAllWithHighlight = character !== 'all';
                let targetCharacter = character;
                
                // 添加封面
                content += `<div class="print-cover">
                    <div class="cover-title">《班级的蜕变》</div>
                    <div class="cover-subtitle">校园教育小品剧本</div>
                    <div class="cover-character">${printAllWithHighlight ? targetCharacter + '角色(全剧本)' : '全部角色台词'}</div>
                    <div class="cover-date">${new Date().toLocaleDateString()}</div>
                    <div class="cover-footer">冷殇科技出品</div>
                </div>
                <div style="page-break-after: always;"></div>`;
                
                // 头部信息
                content += `<div class="print-header">
                    <div class="print-title">《班级的蜕变》剧本台词</div>
                    <div class="print-subtitle">${printAllWithHighlight ? targetCharacter + '角色(全剧本)' : '全部角色台词'}</div>
                </div>`;
                
                // 收集场景描述和旁白文本
                const sceneDescriptions = {};
                const narratorTexts = {};
                
                document.querySelectorAll('.scene').forEach(scene => {
                    let actScene = '';
                    let prevElem = scene.previousElementSibling;
                    
                    while (prevElem) {
                        if (prevElem.tagName === 'H3') {
                            const sceneName = prevElem.textContent;
                            let actName = '';
                            
                            let actElem = prevElem;
                            while (actElem) {
                                if (actElem.tagName === 'H2') {
                                    actName = actElem.textContent;
                                    break;
                                }
                                actElem = actElem.previousElementSibling;
                            }
                            
                            actScene = actName + '|' + sceneName;
                            break;
                        }
                        prevElem = prevElem.previousElementSibling;
                    }
                    
                    if (actScene) {
                        sceneDescriptions[actScene] = scene.innerHTML;
                    }
                });
                
                document.querySelectorAll('.narrator').forEach(narrator => {
                    let actScene = '';
                    let prevElem = narrator;
                    
                    while (prevElem) {
                        if (prevElem.tagName === 'H3') {
                            const sceneName = prevElem.textContent;
                            let actName = '';
                            
                            let actElem = prevElem;
                            while (actElem) {
                                if (actElem.tagName === 'H2') {
                                    actName = actElem.textContent;
                                    break;
                                }
                                actElem = actElem.previousElementSibling;
                            }
                            
                            actScene = actName + '|' + sceneName;
                            break;
                        }
                        prevElem = prevElem.previousElementSibling;
                    }
                    
                    if (actScene) {
                        if (!narratorTexts[actScene]) {
                            narratorTexts[actScene] = [];
                        }
                        narratorTexts[actScene].push(narrator.innerHTML);
                    }
                });
                
                // 按场景组织台词
                let dialoguesByScene = {};
                let currentAct = '';
                let currentScene = '';
                
                dialogues.forEach(dialogue => {
                    const key = dialogue.act + '|' + dialogue.scene;
                    if (!dialoguesByScene[key]) {
                        dialoguesByScene[key] = [];
                    }
                    dialoguesByScene[key].push(dialogue);
                });
                
                // 生成剧本内容
                for (const key in dialoguesByScene) {
                    const [act, scene] = key.split('|');
                    
                    if (act !== currentAct) {
                        currentAct = act;
                        content += `<h2>${currentAct}</h2>`;
                        currentScene = '';
                    }
                    
                    if (scene !== currentScene) {
                        currentScene = scene;
                        content += `<h3>${currentScene}</h3>`;
                        
                        // 添加场景描述
                        if (sceneDescriptions[key]) {
                            content += `<div class="scene-description">${sceneDescriptions[key]}</div>`;
                        }
                    }
                    
                    // 添加旁白文本
                    if (narratorTexts[key] && narratorTexts[key].length > 0) {
                        narratorTexts[key].forEach(narratorText => {
                            content += `<div class="narrator-text">${narratorText}</div>`;
                        });
                    }
                    
                    // 添加台词
                    dialoguesByScene[key].forEach(dialogue => {
                        const isHighlighted = printAllWithHighlight && dialogue.character === targetCharacter;
                        content += `<p style="margin-bottom: 15px; ${isHighlighted ? 'border-bottom: 1px solid #3b82f6;' : ''}">
                            <span class="${isHighlighted ? 'highlighted-character' : ''}" style="font-weight: bold;">
                                ${dialogue.character}：
                            </span> 
                            ${dialogue.dialogue}
                        </p>`;
                    });
                }
                
                // 添加签名栏
                content += `<div class="signature-section">
                    <div class="signature-line"></div>
                    <div class="signature-text">演员签名</div>
                </div>`;
                
                // 添加水印
                content += `<div class="watermark">
                    <p style="font-size: 20px; opacity: 0.7; margin-bottom: 10px;">《班级的蜕变》剧本 - ${new Date().toLocaleDateString()}</p>
                    <p style="font-size: 24px; font-weight: bold; opacity: 0.8;">冷殇科技出品 版权所有</p>
                </div>`;
                
                printContent.innerHTML = content;
                window.print();
            }
            
            function exportToWord(character) {
                const dialogues = collectDialogues();
                let currentAct = '';
                let currentScene = '';
                let exportAllWithHighlight = character !== 'all';
                let targetCharacter = character;
                
                // 创建一个简单的HTML内容，确保兼容性更好
                let content = '';
                content += '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">';
                content += '<head>';
                content += '<meta charset="utf-8">';
                content += '<meta http-equiv="Content-Type" content="text/html; charset=utf-8">';
                content += '<title>班级的蜕变 - ' + (exportAllWithHighlight ? targetCharacter + '角色(全剧本)' : '全部角色') + '台词</title>';
                content += '<style>';
                content += 'body { font-family: 宋体, SimSun, sans-serif; line-height: 1.6; margin: 30px; }';
                content += '.header { text-align: center; margin-bottom: 30px; border-bottom: 1px solid #999; padding-bottom: 20px; }';
                content += '.title { font-size: 22pt; font-weight: bold; margin-bottom: 15px; color: #1e3a8a; }';
                content += '.subtitle { font-size: 16pt; margin-bottom: 20px; color: #444; }';
                content += 'h2 { font-size: 16pt; color: #1e3a8a; border-bottom: 1px solid #999; padding-bottom: 5px; margin-top: 25px; }';
                content += 'h3 { font-size: 14pt; color: #2563eb; margin-top: 15px; margin-left: 10px; }';
                content += '.character { font-weight: bold; color: #1e40af; }';
                content += '.highlighted { background-color: #E6E6FA; font-weight: bold; padding: 2px 5px; border-radius: 3px; }';
                content += '.watermark { text-align: center; font-style: italic; margin-top: 40px; color: #666; }';
                content += 'p { margin: 10px 0 15px 20px; line-height: 1.8; }';
                content += '.highlighted-line { border-bottom: 1px solid #3b82f6; padding-bottom: 5px; }';
                content += 'a { text-decoration: none; color: inherit; }';
                content += '.cover { text-align: center; margin: 100px 0; }';
                content += '.cover-title { font-size: 36pt; font-weight: bold; margin-bottom: 40px; color: #1e3a8a; }';
                content += '.cover-subtitle { font-size: 24pt; margin-bottom: 60px; color: #3b82f6; }';
                content += '.cover-character { font-size: 22pt; border: 2px solid #3b82f6; display: inline-block; padding: 10px 30px; margin-bottom: 80px; border-radius: 8px; }';
                content += '.cover-footer { font-size: 18pt; margin-top: 80px; color: #666; }';
                content += '.signature { text-align: right; margin: 50px 50px 20px 0; }';
                content += '.signature-line { border-top: 1px solid black; width: 200px; margin-left: auto; margin-bottom: 5px; }';
                content += '.signature-text { font-size: 12pt; color: #666; }';
                content += '.page-break { page-break-after: always; }';
                content += '.scene-description { font-style: italic; background-color: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 5px; }';
                content += '.narrator-text { font-style: italic; color: #6b7280; margin: 10px 0 10px 20px; }';
                content += '</style>';
                content += '</head>';
                content += '<body>';
                
                // 添加封面
                content += '<div class="cover">';
                content += '<div class="cover-title">《班级的蜕变》</div>';
                content += '<div class="cover-subtitle">校园教育小品剧本</div>';
                content += '<div class="cover-character">' + (exportAllWithHighlight ? targetCharacter + '角色(全剧本)' : '全部角色台词') + '</div>';
                content += '<div class="cover-footer">冷殇科技出品</div>';
                content += '</div>';
                content += '<div class="page-break"></div>';
                
                // 添加标题
                content += '<div class="header">';
                content += '<div class="title">《班级的蜕变》剧本台词</div>';
                content += '<div class="subtitle">' + (exportAllWithHighlight ? targetCharacter + '角色(全剧本)' : '全部角色台词') + '</div>';
                content += '</div>';
                
                // 收集场景描述和旁白文本
                const sceneDescriptions = {};
                const narratorTexts = {};
                
                document.querySelectorAll('.scene').forEach(scene => {
                    let actScene = '';
                    let prevElem = scene.previousElementSibling;
                    
                    while (prevElem) {
                        if (prevElem.tagName === 'H3') {
                            const sceneName = prevElem.textContent;
                            let actName = '';
                            
                            let actElem = prevElem;
                            while (actElem) {
                                if (actElem.tagName === 'H2') {
                                    actName = actElem.textContent;
                                    break;
                                }
                                actElem = actElem.previousElementSibling;
                            }
                            
                            actScene = actName + '|' + sceneName;
                            break;
                        }
                        prevElem = prevElem.previousElementSibling;
                    }
                    
                    if (actScene) {
                        sceneDescriptions[actScene] = scene.innerHTML;
                    }
                });
                
                document.querySelectorAll('.narrator').forEach(narrator => {
                    let actScene = '';
                    let prevElem = narrator;
                    
                    while (prevElem) {
                        if (prevElem.tagName === 'H3') {
                            const sceneName = prevElem.textContent;
                            let actName = '';
                            
                            let actElem = prevElem;
                            while (actElem) {
                                if (actElem.tagName === 'H2') {
                                    actName = actElem.textContent;
                                    break;
                                }
                                actElem = actElem.previousElementSibling;
                            }
                            
                            actScene = actName + '|' + sceneName;
                            break;
                        }
                        prevElem = prevElem.previousElementSibling;
                    }
                    
                    if (actScene) {
                        if (!narratorTexts[actScene]) {
                            narratorTexts[actScene] = [];
                        }
                        narratorTexts[actScene].push(narrator.innerHTML);
                    }
                });
                
                // 按场景组织台词
                let dialoguesByScene = {};
                
                dialogues.forEach(dialogue => {
                    const key = dialogue.act + '|' + dialogue.scene;
                    if (!dialoguesByScene[key]) {
                        dialoguesByScene[key] = [];
                    }
                    dialoguesByScene[key].push(dialogue);
                });
                
                // 生成剧本内容
                for (const key in dialoguesByScene) {
                    const [act, scene] = key.split('|');
                    
                    if (act !== currentAct) {
                        currentAct = act;
                        content += '<h2>' + currentAct + '</h2>';
                        currentScene = '';
                    }
                    
                    if (scene !== currentScene) {
                        currentScene = scene;
                        content += '<h3>' + currentScene + '</h3>';
                        
                        // 添加场景描述
                        if (sceneDescriptions[key]) {
                            content += '<div class="scene-description">' + sceneDescriptions[key] + '</div>';
                        }
                    }
                    
                    // 添加旁白文本
                    if (narratorTexts[key] && narratorTexts[key].length > 0) {
                        narratorTexts[key].forEach(narratorText => {
                            content += '<div class="narrator-text">' + narratorText + '</div>';
                        });
                    }
                    
                    // 添加台词
                    dialoguesByScene[key].forEach(dialogue => {
                        const isHighlighted = exportAllWithHighlight && dialogue.character === targetCharacter;
                        content += '<p class="' + (isHighlighted ? 'highlighted-line' : '') + '">';
                        content += '<span class="character ' + (isHighlighted ? 'highlighted' : '') + '">' + dialogue.character + '：</span> ';
                        content += dialogue.dialogue;
                        content += '</p>';
                    });
                }
                
                // 添加签名栏
                content += '<div class="signature">';
                content += '<div class="signature-line"></div>';
                content += '<div class="signature-text">演员签名</div>';
                content += '</div>';
                
                // 添加水印
                content += '<div class="watermark">';
                content += '<p style="font-size: 14pt;">《班级的蜕变》剧本 - ' + new Date().toLocaleDateString() + '</p>';
                content += '<p style="font-size: 16pt; font-weight: bold;">冷殇科技出品 版权所有</p>';
                content += '</div>';
                
                content += '</body>';
                content += '</html>';
                
                // 创建Blob，使用更简单的HTML格式
                const blob = new Blob([content], { type: 'application/vnd.ms-word' });
                
                // 创建下载链接
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = '班级的蜕变_' + (exportAllWithHighlight ? targetCharacter + '角色(全剧本)' : '全部角色') + '_台词.doc';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
            
            printButton.addEventListener('click', function() {
                const character = characterSelect.value;
                if (!character) {
                    alert('请选择要打印的角色');
                    return;
                }
                printCharacterDialogues(character);
            });
            
            exportButton.addEventListener('click', function() {
                const character = characterSelect.value;
                if (!character) {
                    alert('请选择要导出的角色');
                    return;
                }
                exportToWord(character);
            });
        });
    </script>
</body>
</html> 
